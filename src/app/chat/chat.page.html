<ion-header class="chat-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <div class="centered-title">MindMate</div>
    <ion-buttons slot="end">
      <div style="width: 32px;"></div>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="gray-background chat-content" [scrollEvents]="true">
  <div class="chat-messages">
    <div *ngFor="let msg of messages">
      <div class="message-row" [ngClass]="msg.role">
        <div *ngIf="msg.role === 'assistant'" class="bubble-avatar">
          <img src="assets/images/Logo.png" alt="MindMate">
        </div>
        <div [ngClass]="msg.role === 'user' ? 'user-bubble' : 'bot-bubble'">
          <p>{{ msg.content }}</p>
        </div>
      </div>
    </div>

    <!-- Typing indicator -->
    <div *ngIf="isTyping" class="message-row assistant">
      <div class="bubble-avatar">
        <img src="assets/images/Logo.png" alt="MindMate">
      </div>
      <div class="bot-bubble typing-indicator">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
</ion-content>

<ion-footer class="chat-footer">
  <!-- Quick response buttons -->
  <div class="quick-responses">
    <ion-chip *ngFor="let response of quickResponses" (click)="useQuickResponse(response)" color="light"
      class="quick-response-chip">
      <ion-label>{{ response }}</ion-label>
    </ion-chip>
  </div>
  <div class="message-input-container">
    <ion-input #chatInput [(ngModel)]="userInput" placeholder="Message..." class="chat-input" inputmode="text"
      (keyup.enter)="sendMessage()"></ion-input>
    <div class="send-button-wrapper">
      <ion-button (click)="sendMessage()" [disabled]="!userInput.trim()" class="send-btn">
        <ion-icon name="send" slot="icon-only"></ion-icon>
      </ion-button>
    </div>
  </div>
</ion-footer>