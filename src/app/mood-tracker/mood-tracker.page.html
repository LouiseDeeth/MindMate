<ion-header class="mood-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button routerLink="/home">
        <img src="assets/images/Home.png" alt="Home Icon" class="home-icon" />
      </ion-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-chip *ngIf="!isGuest" class="profile-icon" (click)="openUserMenu($event)">
        <ion-label>{{ userInitials || 'NA' }}</ion-label>
      </ion-chip>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="gray-background" fullscreen>

  <div class="app-branding">
    <img src="assets/images/Logo.png" alt="MindMate Logo" class="app-logo" />
    <h2 class="app-title">MindMate</h2>
  </div>

  <div class="mood-labels">
    <div class="question">How do you feel today?</div>
    <div class="subtext">I am feeling:</div>
  </div>
   
  <div class="mood-emojis">
    <ion-button fill="clear" *ngFor="let mood of moods; let i = index" (click)="selectMood(i)">
      <img [src]="mood.icon" [alt]="mood.label" [class.selected]="selectedMood === i" />
    </ion-button>
  </div>

  <div class="mood-bar"></div>

  <div class="mood-calendar">
    <ion-datetime
      presentation="date"
      [(ngModel)]="selectedDate"
      (ionChange)="onDateChange()"
      [highlightedDates]="getHighlightedDates()"
      class="calendar-picker">
    </ion-datetime>
  </div>
  
  <!-- Mood History Section -->
  <div class="mood-history">
    <h3>Your Mood History</h3>
    
    <div class="empty-state" *ngIf="objectKeys(moodDates).length === 0">
      <p>You haven't recorded any moods yet.</p>
    </div>
    
    <ion-list *ngIf="objectKeys(moodDates).length > 0">
      <ion-item *ngFor="let entry of getMoodHistoryEntries()">
        <ion-label>
          <h2>{{ entry.date | date:'longDate' }}</h2>
          <p>Mood: {{ moods[entry.moodIndex].label }}</p>
        </ion-label>
        <ion-thumbnail slot="end">
          <img [src]="moods[entry.moodIndex].icon" [alt]="moods[entry.moodIndex].label">
        </ion-thumbnail>
      </ion-item>
    </ion-list>
  </div>
</ion-content>